<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title> New Document </title>
    <meta name="Generator" content="EditPlus">
    <meta name="Author" content="">
    <meta name="Keywords" content="">
    <meta name="Description" content="">

</head>

<body>
<div id="js" style="text-align:center;">
    <textarea id="it" type="text" style="height:50px;font-size:20px;width:600px;height:200px;"></textarea>
    <br>
    <input type="button" value="编码" onclick="bian()"/>
    <input type="button" value="解码" onclick="jie()"/>
    <input type="button" value="转义" onclick="zhuan()"/>
    <input type="button" value="html标签符号转义" onclick="mark()"/>
    <input type="button" value="jquery实现" onclick="change(2)"/>
    <script type="text/javascript" src="../assets/js/jquery.js"></script>
    <!--<script type="text/javascript" src="http://code.jquery.com/jquery-2.1.4.min.js"></script>-->
    <br>
    <textarea id="cont" style="width:400px;height:300px;"></textarea>
</div>
<table align=center id="query" style="text-align:center;display:none;">

    <tr>
        <td colspan=2><input type="button" value="js实现" onclick="change()"/></td>

    </tr>
    <tr>
        <td><label>原始内容</label></td>
        <td><label>编码之后的内容</label></td>
    </tr>
    <tr>
        <td><textarea id="old" type="text" style="height:50px;font-size:20px;width:400px;height:100px;"></textarea></td>
        <td><textarea id="new" type="text" style="height:50px;font-size:20px;width:400px;height:100px;"></textarea></td>
    </tr>
</table>
<script type="text/javascript">

    function bian() {
        var a = document.getElementById("it").value;
        document.getElementById("cont").value = encodeURIComponent(a);
    }

    function jie() {
        var a = document.getElementById("it").value;
        document.getElementById("cont").value = decodeURIComponent(a);
    }

    function mark() {
        var a = document.getElementById("it").value;
        a = escape2Html(a);
        // alert(a);
        document.getElementById("cont").value = a;
    }

    /**
     * 针对左右斜线转义符的转换
     * 示例：https:\u002F\u002Fjsmov2.a.yximgs.com\u002Fbs2\u002FnewWatermark\u002FMjM5NDE3MzM2MTg_zh_4.mp4
     * @returns {string}
     */
    function zhuan() {
        var a = document.getElementById("it").value;
        //先把十六进制unicode编码/u替换为%u
         a= a.replace(/\\u/gi,'%u');
        //再把页面中反斜杠替换为空
        a = a.replace(/\\/gi,'');
        document.getElementById("cont").value = unescape(a);
        return unescape(str);
    }


    //回车转为br标签
    function return2Br(str) {
        return str.replace(/\r?\n/g, "<br />");
    }

    //转意符换成普通字符
    function escape2Html(str) {
        var arrEntities = {'lt': '<', 'gt': '>', 'nbsp': ' ', 'amp': '&', 'quot': '"'};
        return str.replace(/&(lt|gt|nbsp|amp|quot);/ig, function (all, t) {
            return arrEntities[t];
        })//保证 &gt;  和 gt; 两种方式都可以被转换
            .replace(/(lt|gt|nbsp|amp|quot);/ig, function (all, t) {
            return arrEntities[t];
        });
    }



    function change(ch) {
        if (ch == 2) {
            $("#js").css("display", "none");
            $("#query").css("display", "block");
        }
        else {
            $("#js").css("display", "block");
            $("#query").css("display", "none");
        }
    }

    $("#old").keyup(
        function () {
            var a = $(this).val();

            $("#new").val(encodeURIComponent(a));
        }
    );

</script>


</body>
</html>
